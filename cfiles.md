# Системни примитиви за работа с файлове в Linux

## компилиране  на C програма

**cc -o file.exe file.c**

gcc или cc за рънване / рънване на файл и изписва грешките
създава се ./a.out 
и пускаме него евентуално с параметри да го ръннем

## Файлов дескриптор
Неотрицателно цяло число, което служи за уникален идентификатор на отворен файл. Файловите дескриптори имат локално значение за процесите – всеки процес разполага с N файлови дескриптора. Всеки процес стандартно има отворени три дескриптора:

•	0 (стандартен вход)

•	1 (стандартен изход)

•	2 (стандартен изход за грешки)

## Отваряне и създаване на файл

**#include <fcntl.h>**
int open(const char *filename, int oflag [, mode_t mode]);

•	Отваря файл с име filename в режим oflag, а ако не съществува го създава с режим mode.

•	връща файлов дескриптор, с който се работи в програмата или -1 при неуспех

oflag указва режима на отваряне и/или действия, които да се извършат след отваряне:

•	O_RDONLY - само за четене

•	O_WRONLY - само за писане

•	O_RDWR - за четене и писане

•	O_CREAT - създава файла ( ако не съществува се създава трябва задължително права за достъп)

•	O_EXCL - заедно с O_CREAT: ако файлът не съществува, той се създава, иначе се връща грешка

•	O_TRUNC - старото съдържание на файла се изтрива след отваряне

•	O_APPEND - старото съдържание се запазва, а новото се вписва в края на файла

## Четене от файл

**#include <unistd.h>**
ssize_t read(int fd, void *buf, size_t nbytes);
  
•	fd - номер на файлов дескриптор

•	buf - указател към областта от програмата, където се записват данните

•	nbytes - указва броя байтове за четене

•	връща броя на реално прочетените байтове, иначе връща -1

•	при край на файл – 0
(не можем да четем от файл за писане !!!)

## Писане във файл

ssize_t write(int fd, void *buf, size_t nbytes);

•	fd - номер на файлов дескриптор

•	buf - указател към областта от програмата, където се записват данните

•	nbytes - указва броя байтове за писане

•	връща броя на реално записаните байтове, иначе връща -1

## Позициониране във файл

off_t lseek(int fd, off_t offset, int whence);

•	fd - номер на файлов дескриптор

•	offset - самото отместване

•	whence - указва как се интерпретира отместването

o	SEEK_SET - премества указателя от началото до offset-байта

o	SEEK_CUR - премества указателя от сегашната му позиция до offset-байта

o	SEEK_END - премества указателя от края на файла (отзад-напред) до offset-байта (отрицателно число)

## Затваряне на файл
int close(int fd);

## Дублиране на файлов дескриптор

int dup(int oldfd) - дублира файлов дескриптор на първото свободно място

int dup2(int oldfd, int newfd) - дублира файлов дескриптор с посочения

# Main

int main (int argc, char* argv[])

{

	return 0;
 
}

argv[0] –винаги е запазено за програмата параметрите са от 1 ...

ако пише подават се като параметри се намират в argv[1] … argv[n]

argc броят на парамерите 

